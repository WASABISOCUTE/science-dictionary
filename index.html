<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Science Dictionary</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

<h1>ğŸ“˜ ç†ç§‘è¯å…¸</h1>

<input id="search" placeholder="è¾“å…¥è‹±æ–‡ / ä¸­æ–‡ / å­¦ç§‘">

<div id="list"></div>

<!-- è¯¦æƒ…é¡µ -->
<div id="detail" style="display:none;">
  <button id="backBtn">â† è¿”å›</button>
  <h2 id="dEn"></h2>
  <p id="dCn"></p>
  <div id="dTags"></div>
  <p><strong>ç±»åˆ«:</strong> <span id="dCategory"></span></p>
  <p id="dUsage"></p>
  <p><strong>å…¬å¼:</strong> <span id="dFormula"></span></p>
  <div id="dSimilar"><strong>ç›¸å…³å•è¯:</strong></div>
</div>

<script src="data.js"></script>
<script>
const input = document.getElementById("search");
const list = document.getElementById("list");
const detail = document.getElementById("detail");
const backBtn = document.getElementById("backBtn");

const dEn = document.getElementById("dEn");
const dCn = document.getElementById("dCn");
const dTags = document.getElementById("dTags");
const dCategory = document.getElementById("dCategory");
const dUsage = document.getElementById("dUsage");
const dFormula = document.getElementById("dFormula");
const dSimilar = document.getElementById("dSimilar");

// æ¸²æŸ“åˆ—è¡¨é¡µ
function render(items) {
  list.innerHTML = "";
  items.forEach(w => {
    const div = document.createElement("div");
    div.className = "card";
// åˆ—è¡¨é¡µæ ‡ç­¾
div.innerHTML = `
  <h2>${w.en}</h2>
  <p>${w.cn}</p>
  <div class="tags">
    ${(w.tags || []).map(t => `<span class="tag ${t}" onclick="filterByTag('${t}')">${t}</span>`).join("")}
  </div>
`;

    div.addEventListener("click", () => showDetail(w));
    list.appendChild(div);
  });
}

// æ˜¾ç¤ºè¯¦æƒ…é¡µ
function showDetail(word) {
  list.style.display = "none";
  detail.style.display = "block";

  dEn.textContent = word.en;
  dCn.textContent = word.cn;
 // è¯¦æƒ…é¡µæ ‡ç­¾
  dTags.innerHTML = (word.tags || []).map(t => `<span class="tag ${t}" onclick="filterByTag('${t}')">${t}</span>`).join("");
  dCategory.textContent = word.category || "";
  dUsage.textContent = word.usage || "";
  dFormula.innerHTML = word.formula ? `\\(${word.formula}\\)` : "æ— ";

  // ç›¸å…³å•è¯
  const similarList = word.similar || [];
  dSimilar.innerHTML = "<strong>ç›¸å…³å•è¯:</strong> ";
  if(similarList.length > 0){
    similarList.forEach(sim => {
      const simWord = words.find(w => w.en === sim);
      if(simWord){
        const btn = document.createElement("button");
        btn.textContent = simWord.en;
        btn.className = "tag";
        btn.addEventListener("click", () => showDetail(simWord));
        dSimilar.appendChild(btn);
      }
    });
  } else {
    dSimilar.innerHTML += "æ— ";
  }

  MathJax.typesetPromise(); // æ¸²æŸ“å…¬å¼
}

// è¿”å›åˆ—è¡¨é¡µ
backBtn.addEventListener("click", () => {
  detail.style.display = "none";
  list.style.display = "block";
});

// æœç´¢
input.addEventListener("input", () => {
  const q = input.value.toLowerCase();
  const result = words.filter(w =>
    w.en.toLowerCase().includes(q) ||
    w.cn.includes(q) ||
    (w.tags || []).join("").toLowerCase().includes(q)
  );
  render(result);
});

// åˆå§‹æ¸²æŸ“
render(words);

// ç‚¹å‡»æ ‡ç­¾ç­›é€‰
function filterByTag(tag) {
  const result = words.filter(w => (w.tags || []).includes(tag));
  render(result);
}

</script>

</body>
</html>
